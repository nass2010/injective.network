import{dq as qe,dr as x,dG as R,dH as t,dT as ce,br as G,bw as $e,bj as ue,dY as me,dZ as pe,bs as i,dN as Ne,o as ke,a6 as fe,B as z,ee as we,e0 as de,ao as B,d$ as at,dI as o,c3 as s,dt as l,bm as e,dp as T,dJ as P,dd as Ce,ds as L,dV as ve,du as ne,dv as ge,dW as Je,ez as ot,e5 as st,bh as F,dO as ee,c1 as ye,bq as He,dK as nt,ei as lt,e1 as je,eA as X,bv as it,dQ as rt,bS as J,dU as dt,dP as Ie,bz as ct,dR as ut,c0 as mt}from"./injective.5ec62b21.js";import{_ as _e}from"./Button.vue.042b9f8c.js";import{u as pt,e as xe,b as ze,f as De,I as Ge,U as N,ag as Re,z as gt,d as be,Z as Se,M as Q,ah as Fe,a as he,aa as j,ai as Oe,c as Ve,aj as se,ak as Ee}from"./entry.d056f6df.js";import{u as Z}from"./staking.537f9838.js";import{g as _t}from"./currency.3c5184cf.js";import{_ as Be}from"./TableHeader.vue.efcee495.js";import{_ as Pe}from"./ValidatorIcon.vue.7b5bd314.js";import{_ as Te,a as Me}from"./TableBody.vue.d7c633b3.js";import{_ as Ze,a as Ke,b as Ye,c as ft}from"./Unbond.vue.a40485bd.js";import{_ as Ue,a as vt}from"./NumericInput.vue.aa13647e.js";import{_ as ht}from"./Wrapper.vue.a6439622.js";import{_ as $t}from"./Checkbox.vue.a14dd9f1.js";import{_ as yt}from"./Modal.vue.62282f1c.js";import{f as xt}from"./index.9ecd3324.js";import{f as Le}from"./index.13982607.js";import{_ as bt}from"./HocLoading.vue.2c565178.js";import{_ as wt}from"./Card.vue.54e49112.js";import{_ as At}from"./Item.vue.753c2598.js";import{u as Qe}from"./params.91d130ab.js";import{_ as kt}from"./Search.e9d0f53f.js";import{_ as St}from"./ButtonSelect.vue.3a90a9ca.js";import{_ as Ct}from"./SortableHeaderItem.vue.b69958b7.js";import{_ as It}from"./client-only.dd3103d8.js";import{u as Dt}from"./exchange.403a40d2.js";import{o as Rt}from"./onWalletConnected.dbabd086.js";import"./axelar.f734343d.js";import"./injective-wallet.1bcffa89.js";import"./injective-bridge.07091654.js";import"./pagination.debc7c70.js";import"./Input.vue.63a14335.js";import"./index.76ce090a.js";import"./index.379cfe5b.js";import"./index.1ac1b5bb.js";import"./index.129eae63.js";import"./index.00c12b3f.js";const Vt={},Bt={class:"bg-gray-200 dark:bg-gray-900 p-8 rounded-xl shadow-primaryLight dark:shadow-dark-sm"},Pt={class:"text-gray-500 pb-2"},Tt={class:"text-2xl"};function Mt(u,m){return x(),R("div",Bt,[t("div",Pt,[ce(u.$slots,"header")]),t("div",Tt,[ce(u.$slots,"content")])])}const Ut=qe(Vt,[["render",Mt]]),Nt={class:"text-sm uppercase text-gray-500 mb-6 font-semibold"},jt={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6"},Ft=t("span",{class:"ml-2 text-sm text-gray-500"},"INJ",-1),Ot={class:"text-base text-gray-500 mt-2"},Et={class:"grid grid-cols-1 2xl:grid-cols-[1fr_auto]"},Lt={class:"flex-1"},Wt=t("span",{class:"ml-2 text-sm text-gray-500"},"INJ",-1),qt={class:"text-base text-gray-500 mt-2"},Jt={class:"flex-1"},Ht=t("span",{class:"ml-2 text-sm text-gray-500"},"INJ",-1),zt={class:"text-base text-gray-500 mt-2"},Gt=G({__name:"StakingOverview",setup(u){const m=pt(),a=xe(),n=ze(),r=Z(),{success:A}=Ce(),{$onError:c}=$e(),{t:b}=De(),w=ue(new me(pe.Idle)),p=i(()=>{const S=n.tokenUsdPrice(Ge);if(!S)return Ne;const $=_t(S);return new ke($[m.currency.code])}),f=i(()=>{const S=a.balances[fe];return S?new z(S).toBase():Ne}),V=i(()=>f.value.times(p.value).toFormat(N)),I=i(()=>r.delegations.filter($=>$.balance.denom===fe).reduce(($,O)=>$.plus(O.balance.amount),we).toBase()),{valueToString:_}=de(i(()=>I.value),{minimalDecimalPlaces:N}),{valueToString:v}=de(i(()=>new B(I.value).times(p.value)),{minimalDecimalPlaces:N}),d=i(()=>r.rewards.reduce((S,$)=>{const y=$.rewards.filter(C=>C.denom===fe).reduce((C,U)=>C.plus(U.amount),we);return S.plus(y)},we).toBase()),h=i(()=>d.value.toFormat(N)),M=i(()=>new B(d.value).times(p.value).toFormat(N)),{valueToString:D}=de(f),W=i(()=>r.rewards.filter(S=>{const $=S.rewards.find(O=>O.denom===fe);return new z($?$.amount:0).toBase()}));function q(){const S=W.value.map($=>$.validatorAddress);w.setLoading(),r.claimAllRewards(S).then(()=>{A({title:b("Successfully Claimed Rewards")}),Re.trackClaimAllEvent()}).catch(c).finally(()=>{w.setIdle()})}return at(r.fetchRewards,30*1e3),(S,$)=>{const O=Ut,y=_e;return x(),R("div",null,[t("p",Nt,o(S.$t("staking.yourStakingStats")),1),t("div",jt,[s(O,null,{header:l(()=>[t("p",null,o(S.$t("Delegations")),1)]),content:l(()=>[t("p",null,o(e(r).delegations.length)+" "+o(e(r).delegations.length>1?"Validators":"Validator"),1)]),_:1}),s(O,null,{header:l(()=>[t("p",null,o(S.$t("staking.yourStakedAmount")),1)]),content:l(()=>[t("div",null,[t("span",null,o(e(_)),1),Ft]),t("p",Ot,o(e(m).currency.symbol)+" "+o(e(v)),1)]),_:1}),s(O,null,{header:l(()=>[t("p",null,o(S.$t("Claimable Rewards")),1)]),content:l(()=>[t("div",Et,[t("div",Lt,[t("div",null,[t("span",null,o(e(h)),1),Wt]),t("p",qt,o(e(m).currency.symbol)+" "+o(e(M)),1)]),t("div",null,[s(y,T({primary:"",class:"w-full mt-2"},{disabled:e(W).length===0,status:e(w)},{onClick:q}),{default:l(()=>[P(o(S.$t("Claim All")),1)]),_:1},16)])])]),_:1}),s(O,null,{header:l(()=>[t("p",null,o(S.$t("staking.availableInjInWallet")),1)]),content:l(()=>[t("div",null,[t("div",Jt,[t("div",null,[t("span",null,o(e(D)),1),Ht]),t("p",zt,o(e(m).currency.symbol)+" "+o(e(V)),1)])])]),_:1})])])}}}),Zt={class:"flex items-center gap-2 cursor-pointer select-none"},Xe=G({__name:"SortableHeaderItem",props:{isAscending:Boolean,value:{type:String,required:!0},sortBy:{type:String,required:!0}},setup(u){return(m,a)=>{const n=Je,r=ot;return x(),L(r,ne(ge({value:u.value,sortBy:u.sortBy,isAscending:u.isAscending,...m.$attrs})),{default:l(({isActive:A})=>[t("div",Zt,[ce(m.$slots,"default"),t("div",{class:ve(["transition-all",[A?"text-gray-600 dark:text-green-500":"text-green-600 dark:text-green-700",{"rotate-180":u.isAscending&&A}]])},[s(n,{name:"triangle","is-xs":""})],2)])]),_:3},16)}}}),Kt={},Yt=["onClick"];function Qt(u,m){const a=st;return x(),L(a,null,{default:l(({isOpen:n})=>[ce(u.$slots,"default",ne(ge({isOpen:n})))]),content:l(({close:n})=>[t("div",{class:"flex flex-col p-2",onClick:n},[ce(u.$slots,"content")],8,Yt)]),_:3})}const Xt=qe(Kt,[["render",Qt]]);function Ae(u){let m,a=u[0],n=1;for(;n<u.length;){const r=u[n],A=u[n+1];if(n+=2,(r==="optionalAccess"||r==="optionalCall")&&a==null)return;r==="access"||r==="optionalAccess"?(m=a,a=A(a)):(r==="call"||r==="optionalCall")&&(a=A((...c)=>a.call(m,...c)),m=void 0)}return a}const ea={class:"col-span-4 xl:col-span-2 xl:text-right"},ta={key:0,class:"space-x-2"},aa={class:"font-semibold"},oa=t("span",{class:"text-gray-500"},"INJ",-1),sa={key:1},na={class:"col-span-4 xl:col-span-2 xl:text-right"},la={class:"col-span-4 xl:col-span-2 xl:text-right space-x-2"},ia={class:"font-semibold"},ra=t("span",{class:"text-gray-500"}," INJ ",-1),da={class:"flex items-center justify-end col-span-4 dark:text-primary-500 font-semibold"},ca={class:"grid grid-cols-2 md:grid-cols-3"},ua={class:"max-md:col-span-2 flex justify-end"},ma={class:"text-primary-800 dark:text-primary-500"},pa={class:"flex flex-col"},ga=G({__name:"Row",props:{delegation:{type:Object,required:!0},totalDelegatedAmount:{required:!0,type:String}},emits:["unbond","re-delegate","delegate"],setup(u,{emit:m}){const a=u,n=Z(),{success:r}=Ce(),{$onError:A}=$e(),{t:c}=De(),b=ue(new me(pe.Idle)),w=F(!1),p=F(!1),f=F(null),V=i(()=>new z(a.delegation.rewards.rewards[0]&&a.delegation.rewards.rewards[0].amount||0).toBase()),I=i(()=>V.value.gt(gt)),_=i(()=>new z(Ae([a,"access",g=>g.delegation,"access",g=>g.delegation,"optionalAccess",g=>g.balance,"access",g=>g.amount])||0).toBase()),{valueToString:v}=de(i(()=>_.value),{minimalDecimalPlaces:N}),d=i(()=>a.delegation.validator?new B(a.delegation.validator.commissionRate).times(100).toFormat(N):"0"),h=i(()=>new z(Ae([a,"access",g=>g.delegation,"optionalAccess",g=>g.rewards,"optionalAccess",g=>g.rewards,"access",g=>g[0]])&&Ae([a,"access",g=>g.delegation,"optionalAccess",g=>g.rewards,"optionalAccess",g=>g.rewards,"access",g=>g[0],"access",g=>g.amount])||0)),M=i(()=>new B(a.delegation.validator.delegatorShares).dividedBy(a.totalDelegatedAmount).times(100).toFormat(N)),{valueToString:D}=de(i(()=>h.value.toBase()),{minimalDecimalPlaces:N});function W(){f.value==="delegation"&&a.delegation.validator&&m("delegate",a.delegation.validator),f.value==="redelegation"&&a.delegation.delegation&&m("re-delegate",a.delegation.delegation)}function q(){w.value=!0}function S(){w.value=!1,He(()=>{f.value=null})}function $(){p.value=!0}function O(){p.value=!1}function y(g){return f.value=g,new B(d.value).isEqualTo(100)?q():U()}function C(){b.setLoading(),a.delegation.validator&&n.claimRewardsFromValidator(a.delegation.validator.address).then(()=>{r({title:c("Successfully Claimed")}),Re.trackClaimEvent(a.delegation.validator.address)}).catch(A).finally(()=>{b.setIdle()})}function U(){return new B(M.value).gt("5")?$():W()}return(g,H)=>{const te=Pe,le=nt,k=_e,E=Je,K=Xt,ie=Te,ae=Ze,re=Ke;return x(),R(ye,null,[s(ie,null,{default:l(()=>[u.delegation.validator?(x(),L(le,{key:0,to:{name:"validators-validator",params:{validator:u.delegation.validator.operatorAddress}},class:"col-span-4 xl:col-span-2 flex items-center space-x-2"},{default:l(()=>[s(te,T({validator:u.delegation.validator},{sm:""}),null,16),t("span",null,o(u.delegation.validator.name),1)]),_:1},8,["to"])):ee("",!0),t("span",ea,[e(_).gt(0)?(x(),R("span",ta,[t("span",aa,o(e(v)),1),oa])):(x(),R("span",sa," - "))]),t("span",na,o(e(d))+"% ",1),t("span",la,[t("span",ia,o(e(D)),1),ra]),t("div",da,[t("div",ca,[s(k,{primary:"",text:"",onClick:H[0]||(H[0]=oe=>y("delegation"))},{default:l(()=>[P(o(g.$t("Delegate")),1)]),_:1}),s(k,{primary:"",text:"",status:e(b),disabled:!e(I),onClick:C},{default:l(()=>[P(o(g.$t("Claim")),1)]),_:1},8,["status","disabled"]),t("div",ua,[e(_).gt(0)?(x(),L(K,{key:0},{default:l(({isOpen:oe})=>[s(k,{class:"flex items-center space-x-2"},{default:l(()=>[t("span",ma,o(g.$t("More")),1),t("span",{class:ve(["transition-all",{"rotate-180":oe}])},[s(E,{name:"chevron-down","is-sm":""})],2)]),_:2},1024)]),content:l(()=>[t("div",pa,[t("button",{class:"text-sm text-primary-800 dark:text-primary-500 p-2 rounded-md font-semibold hover:bg-primary-500 hover:text-black dark:hover:text-black",text:"",onClick:H[1]||(H[1]=oe=>y("redelegation"))},o(g.$t("Re Delegate")),1),t("button",{class:"text-sm text-primary-800 dark:text-primary-500 p-2 rounded-md font-semibold hover:bg-primary-500 hover:text-black dark:hover:text-black",text:"",onClick:H[2]||(H[2]=oe=>g.$emit("unbond",u.delegation.delegation))},o(g.$t("Unbond")),1)])]),_:1})):ee("",!0)])])])]),_:1}),s(ae,T({isOpen:e(w)},{"onModal:closed":S,onConfirmed:U}),null,16),s(re,T({isOpen:e(p)},{"onModal:closed":O,onConfirmed:W}),null,16)],64)}}}),_a={class:"relative mt-8"},fa={class:"text-center"},va={class:"flex items-center justify-center"},ha={class:"text-xs font-semibold uppercase text-gray-700 dark:text-gray-200"},$a={class:"mt-4 text-center"},ya={class:"flex items-center justify-center font-mono text-2xl text-gray-700 dark:text-gray-200"},xa=t("span",{class:"ml-2 text-gray-400 dark:text-gray-500"},"INJ",-1),ba={class:"mt-4 text-white"},wa={class:"flex flex-wrap"},Aa={class:"w-full"},ka={class:"mt-4 w-full"},Sa=t("span",null,"INJ",-1),Ca={key:0,class:"pt-4"},Ia={class:"font-bold uppercase text-red-300"},Da={class:"font-bold uppercase underline"},Ra={class:"pt-2 flex justify-end"},Va={class:"mt-8 w-full text-center"},Ba={key:0},Pa={key:1},Ta=G({__name:"ReDelegate",props:{delegation:{type:Object,default:void 0}},emits:["modal:closed"],setup(u,{emit:m}){const a=u,n=xe(),r=be(),A=Z(),{$onError:c}=$e(),{success:b}=Ce(),{t:w}=De(),{errors:p,validate:f,resetForm:V}=lt(),I=ue(new me(pe.Idle)),_=F(!1),v=i(()=>a.delegation?new z(a.delegation.balance.amount).toBase():Se),d=i(()=>n.hasEnoughInjForGas),h=i(()=>{if(!a.delegation||!a.delegation.delegation)return;const k=a.delegation.delegation.validatorAddress;return A.validators.find(E=>E.address===k)}),M=i(()=>r.modals[Q.ReDelegate]&&h.value!==void 0),{value:D,errors:W}=je({name:"destination",initialValue:""}),{value:q,errors:S}=je({name:"amount",rule:"required:positiveNumber",dynamicRule:i(()=>`between:${new ke(1).shiftedBy(-Fe).toFixed()},${v.value.toFixed()}`),initialValue:""}),$=i(()=>h.value?A.validators.filter(k=>{if(!h.value)return!1;const E=k.status===X.Bonded,K=k.jailed;return k.address!==h.value.address&&E&&!K}):[]),O=i(()=>h.value?A.validators.filter(k=>{if(!h.value)return!1;const E=[X.UnBonded,X.UnBonding].includes(k.status),K=k.jailed;return(E||K)&&k.address!==h.value.address}).map(k=>({...k,name:`${k.name} (inactive)`})):[]),y=i(()=>A.validators.filter(k=>new B(k.commissionRate).isEqualTo(1)).map(k=>k.address)),C=i(()=>y.value.includes(D.value)),U=i(()=>C.value?_.value:!0),g=i(()=>Object.keys(p.value).length===0),H=i(()=>v.value.eq(0)?"0":v.value.lt(he)?`< ${he.toFormat(N)}`:v.value.toFormat(N,ke.ROUND_DOWN));function te(){m("modal:closed"),r.closeModal(Q.ReDelegate)}async function le(){const{valid:k}=await f();!a.delegation||!h.value||!k||(I.setLoading(),A.reDelegate({destinationValidatorAddress:D.value,sourceValidatorAddress:h.value.address,denom:a.delegation.balance.denom,amount:new B(q.value)}).then(()=>{b({title:w("Successfully Re Delegated")}),Re.trackRedelegateEvent(),V()}).catch(c).finally(()=>{I.setIdle(),He(()=>{te()})}))}return it(D,()=>{_.value=!1}),(k,E)=>{const K=Ue,ie=ht,ae=vt,re=rt("i18n-t"),oe=$t,et=_e,tt=yt;return x(),L(tt,{"is-open":e(M),ignore:[".v-popper__popper"],"onModal:closed":te},{title:l(()=>[t("h3",null,o(k.$t("reDelegateFromValidator",{validator:e(h)?e(h).name:""})),1)]),default:l(()=>[t("div",_a,[t("div",fa,[t("div",va,[t("p",ha,o(k.$t("Available for Re Delegation")),1),s(K,{class:"ml-2 text-gray-700 dark:text-gray-200",tooltip:k.$t("Available for Re Delegation Tooltip")},null,8,["tooltip"])]),t("div",$a,[t("span",ya,[P(o(e(H))+" ",1),xa])])]),t("div",ba,[t("div",wa,[t("div",Aa,[s(ie,{modelValue:e(D),"onUpdate:modelValue":E[0]||(E[0]=Y=>J(D)?D.value=Y:null),errors:e(I).isLoading()?[]:e(W),options:[...e($),...e(O)].map(Y=>({value:Y.address,display:Y.name})),label:k.$t("Validator"),placeholder:k.$t("Select Validator"),"is-valid":e(W).length===0,"is-clearable":"","is-searchable":""},null,8,["modelValue","errors","options","label","placeholder","is-valid"])]),t("div",ka,[s(ae,{modelValue:e(q),"onUpdate:modelValue":E[1]||(E[1]=Y=>J(q)?q.value=Y:null),errors:e(I).isLoading()?[]:e(S),valid:e(S).length===0,max:e(v).toFixed(),"max-decimals":e(Fe),label:k.$t("amount"),placeholder:k.$t("Enter your amount to be re delegated")},{addon:l(()=>[Sa]),_:1},8,["modelValue","errors","valid","max","max-decimals","label","placeholder"])]),e(C)?(x(),R("div",Ca,[s(re,{keypath:"delegationWarningMessage",tag:"p",class:"text-xs"},{caution:l(()=>[t("span",Ia,o(k.$t("caution")),1)]),noRewards:l(()=>[t("span",Da,o(k.$t("noRewards")),1)]),_:1}),t("div",Ra,[s(oe,{modelValue:e(_),"onUpdate:modelValue":E[2]||(E[2]=Y=>J(_)?_.value=Y:null)},{default:l(()=>[P(o(k.$t("iAgree"))+". ",1)]),_:1},8,["modelValue"])])])):ee("",!0),t("div",Va,[s(et,{lg:"",class:"w-full",status:e(I),primary:e(g),disabled:!e(g)||!e(d)||!e(U),onClick:dt(le,["stop"])},{default:l(()=>[e(d)?(x(),R("span",Pa,o(k.$t("Re Delegate")),1)):(x(),R("span",Ba,o(k.$t("insufficientGas.insufficientGas")),1))]),_:1},8,["status","primary","disabled","onClick"])])])])])]),_:1},8,["is-open","ignore"])}}});function We(u){let m,a=u[0],n=1;for(;n<u.length;){const r=u[n],A=u[n+1];if(n+=2,(r==="optionalAccess"||r==="optionalCall")&&a==null)return;r==="access"||r==="optionalAccess"?(m=a,a=A(a)):(r==="call"||r==="optionalCall")&&(a=A((...c)=>a.call(m,...c)),m=void 0)}return a}const Ma={class:"col-span-2"},Ua={class:"font-semibold text-gray-400"},Na={class:"col-span-2"},ja={class:"font-normal text-gray-700 dark:text-gray-300"},Fa={class:"col-span-2"},Oa={class:"font-normal text-gray-700 dark:text-gray-300"},Ea={class:"col-span-2"},La={class:"font-normal text-gray-700 dark:text-gray-300"},Wa=G({__name:"Index",props:{totalDelegatedAmount:{required:!0,type:String}},setup(u){const m=be(),a=Z(),n=F(""),r=F(!1),A=F(void 0),c=F(void 0),b=i(()=>{const _=a.delegations.map(d=>{const h=a.rewards.find(D=>D.validatorAddress===d.delegation.validatorAddress),M=a.validators.find(D=>D.operatorAddress===d.delegation.validatorAddress);return{delegation:d,rewards:h,validator:M}}),v=a.rewards.filter(d=>!a.delegations.find(h=>h.delegation.validatorAddress===d.validatorAddress)&&d.rewards.length>0).map(d=>{const h=a.validators.find(D=>D.operatorAddress===d.validatorAddress),M=a.delegations.find(D=>D.delegation.validatorAddress===d.validatorAddress);return{validator:h,delegation:M,rewards:d}});return[..._,...v]}),w=i(()=>n.value===j.StakedAmount?[...b.value].sort((_,v)=>new z(We([v,"access",d=>d.delegation,"optionalAccess",d=>d.balance,"access",d=>d.amount])||1).minus(We([_,"access",d=>d.delegation,"optionalAccess",d=>d.balance,"access",d=>d.amount])||1).toNumber()):n.value===j.Commission?[...b.value].sort((_,v)=>new B(_.validator.commissionRate).minus(new B(v.validator.commissionRate)).toNumber()):n.value===j.Rewards?[...b.value].sort((_,v)=>new z(v.rewards.rewards[0]&&v.rewards.rewards[0].amount||0).minus(new z(_.rewards.rewards[0]&&_.rewards.rewards[0].amount)||0).toNumber()):b.value),p=i(()=>r.value?[...w.value].reverse():w.value);function f(_){A.value=_,m.openModal(Q.DelegateToValidator)}function V(_){c.value=_,m.openModal(Q.Unbond)}function I(_){c.value=_,m.openModal(Q.ReDelegate)}return(_,v)=>{const d=Xe,h=Be,M=ga,D=Me,W=Ye,q=ft,S=Ta;return x(),R("div",null,[s(h,null,{default:l(()=>[t("span",Ma,[t("span",Ua,o(_.$t("Delegations")),1)]),t("span",Na,[s(d,T({isAscending:e(r),sortBy:e(n),value:e(j).StakedAmount},{"sort-by":e(n),"onUpdate:sortBy":v[0]||(v[0]=$=>J(n)?n.value=$:null),"is-ascending":e(r),"onUpdate:isAscending":v[1]||(v[1]=$=>J(r)?r.value=$:null),class:"justify-end flex"}),{default:l(()=>[t("span",ja,o(_.$t("Staked Amount")),1)]),_:1},16,["sort-by","is-ascending"])]),t("span",Fa,[s(d,T({isAscending:e(r),sortBy:e(n),value:e(j).Commission},{"sort-by":e(n),"onUpdate:sortBy":v[2]||(v[2]=$=>J(n)?n.value=$:null),isAscending:e(r),"onUpdate:isAscending":v[3]||(v[3]=$=>J(r)?r.value=$:null),class:"justify-end flex"}),{default:l(()=>[t("span",Oa,o(_.$t("Commission")),1)]),_:1},16,["sort-by","isAscending"])]),t("span",Ea,[s(d,T({isAscending:e(r),sortBy:e(n),value:e(j).Rewards},{"sort-by":e(n),"onUpdate:sortBy":v[4]||(v[4]=$=>J(n)?n.value=$:null),isAscending:e(r),"onUpdate:isAscending":v[5]||(v[5]=$=>J(r)?r.value=$:null),class:"justify-end flex"}),{default:l(()=>[t("span",La,o(_.$t("Rewards")),1)]),_:1},16,["sort-by","isAscending"])])]),_:1}),s(D,null,{default:l(()=>[(x(!0),R(ye,null,Ie(e(p),$=>(x(),L(M,T({key:`delegation-${$.validator.address}`},{delegation:$,totalDelegatedAmount:u.totalDelegatedAmount},{onDelegate:f,onUnbond:V,onReDelegate:I}),null,16))),128))]),_:1}),s(W,ne(ge({validator:e(A)})),null,16),s(q,T({delegation:e(c)},{"onModal:closed":v[6]||(v[6]=$=>c.value=void 0)}),null,16),s(S,T({delegation:e(c)},{"onModal:closed":v[7]||(v[7]=$=>c.value=void 0)}),null,16)])}}}),qa={key:0,class:"col-span-4 xl:col-span-1 flex items-center space-x-2"},Ja={class:"col-span-4 xl:col-span-3 space-x-2 xl:text-right"},Ha={class:"font-semibold"},za=t("span",{class:"text-gray-500"},"INJ",-1),Ga={class:"col-span-4 xl:col-span-2 capitalize xl:text-right"},Za={class:"col-span-4 xl:col-span-6 xl:text-right"},Ka={class:"font-semibold"},Ya=G({__name:"Row",props:{unbondingRedelegation:{type:Object,required:!0}},setup(u){const m=u,a=Z(),n=i(()=>a.validators.find(w=>w.operatorAddress===m.unbondingRedelegation.validatorAddress)),r=i(()=>new z(m.unbondingRedelegation.balance).toBase()),A=i(()=>r.value.eq(0)?"0":r.value.lte(he)?`< ${he.toFormat(N)}`:r.value.toFormat(N)),c=i(()=>xt(Le(m.unbondingRedelegation.completionTime),{addSuffix:!0})),b=i(()=>Le(m.unbondingRedelegation.completionTime).toLocaleDateString("en-US",{dateStyle:"medium"}));return(w,p)=>{const f=Pe,V=Te;return x(),L(V,null,{default:l(()=>[e(n)?(x(),R("span",qa,[t("div",null,[s(f,T({sm:""},{validator:e(n)}),null,16)]),t("span",null,o(e(n).name),1)])):ee("",!0),t("span",Ja,[t("span",Ha,o(e(A)),1),za]),t("span",Ga,o(m.unbondingRedelegation.status),1),t("span",Za,[t("span",Ka,o(e(c)),1),P(" - "+o(e(b)),1)])]),_:1})}}}),Qa={class:"col-span-1"},Xa={class:"font-semibold text-gray-400"},eo={class:"col-span-3"},to={class:"font-normal text-gray-700 dark:text-gray-300"},ao={class:"col-span-2"},oo={class:"flex justify-end"},so={class:"col-span-6"},no={class:"font-normal text-gray-700 dark:text-gray-300"},lo=G({__name:"Index",setup(u){const m=Z(),a=F(""),n=F(!1),r=i(()=>m.unbondingDelegations.map(p=>({validatorAddress:p.validatorAddress,status:Oe.Unbonding,completionTime:p.completionTime,balance:p.balance}))),A=i(()=>m.reDelegations.map(p=>({validatorAddress:p.delegation.sourceValidatorAddress,status:Oe.Redelegation,completionTime:p.delegation.completionTime,balance:p.balance}))),c=i(()=>[...r.value,...A.value]),b=i(()=>a.value===j.StakedAmount?[...c.value].sort((p,f)=>new z(p.balance).minus(new z(f.balance)).toNumber()):a.value===j.CompletionTime?[...c.value].sort((p,f)=>p.completionTime-f.completionTime):c.value),w=i(()=>n.value?b.value:[...b.value].reverse());return(p,f)=>{const V=Xe,I=Be,_=Ya,v=Me;return x(),R("div",null,[s(I,null,{default:l(()=>[t("span",Qa,[t("span",Xa,o(p.$t("staking.unbondingsRedelegate")),1)]),t("span",eo,[s(V,T({isAscending:e(n),sortBy:e(a),value:e(j).StakedAmount},{"sort-by":e(a),"onUpdate:sortBy":f[0]||(f[0]=d=>J(a)?a.value=d:null),"is-ascending":e(n),"onUpdate:isAscending":f[1]||(f[1]=d=>J(n)?n.value=d:null),class:"justify-end flex"}),{default:l(()=>[t("span",to,o(p.$t("amount")),1)]),_:1},16,["sort-by","is-ascending"])]),t("span",ao,[t("span",oo,o(p.$t("status")),1)]),t("span",so,[s(V,T({isAscending:e(n),sortBy:e(a),value:e(j).CompletionTime},{"sort-by":e(a),"onUpdate:sortBy":f[2]||(f[2]=d=>J(a)?a.value=d:null),isAscending:e(n),"onUpdate:isAscending":f[3]||(f[3]=d=>J(n)?n.value=d:null),class:"justify-end flex"}),{default:l(()=>[t("span",no,o(p.$t("staking.completionTime")),1)]),_:1},16,["sort-by","isAscending"])])]),_:1}),s(v,null,{default:l(()=>[(x(!0),R(ye,null,Ie(e(w),(d,h)=>(x(),L(_,T({key:`unbonding-redelegation-${h}`},{unbondingRedelegation:d}),null,16))),128))]),_:1})])}}}),io={class:"4xl:grid-cols-4 xs:gap-6 2md:gap-6 grid grid-cols-2 gap-4 md:gap-4 lg:grid-cols-4"},ro={key:0,class:"font-mono"},co={key:1,class:"font-mono"},uo={class:"font-mono"},mo={key:0,class:"font-mono"},po=t("span",{class:"text-xs text-gray-400 dark:text-gray-500"},"INJ",-1),go={key:1,class:"font-mono"},_o={key:0},fo={class:"font-mono"},vo=t("span",{class:"text-xs text-gray-400 dark:text-gray-500"},"INJ",-1),ho={key:1},$o=G({__name:"Stats",props:{totalDelegatedAmount:{required:!0,type:String}},setup(u){const m=u,a=Ve(),n=Z(),r=xe(),A=Qe(),c=i(()=>new B(A.apr).times(100).toFormat(N)),b=i(()=>new B(r.injectiveBalance)),w=i(()=>b.value.toFormat(N)),p=i(()=>new z(m.totalDelegatedAmount).toBase().toFormat(N));return(f,V)=>{const I=At;return x(),R("div",io,[s(I,null,{value:l(()=>[e(n).validators.length>0?(x(),R("span",ro,o(e(n).validators.length),1)):(x(),R("span",co,"—"))]),title:l(()=>[P(o(f.$t("Total Validators")),1)]),_:1}),s(I,null,{value:l(()=>[t("span",uo,o(e(c))+"%",1)]),title:l(()=>[P(o(f.$t("staking.apr")),1)]),_:1}),s(I,null,{value:l(()=>[e(n).validators.length>0?(x(),R("span",mo,[P(o(e(p))+" ",1),po])):(x(),R("span",go,"—"))]),title:l(()=>[P(o(f.$t("Total INJ Staked")),1)]),_:1}),s(I,null,{value:l(()=>[e(a).isUserWalletConnected&&e(b).gt(0)?(x(),R("span",_o,[t("span",fo,[P(o(e(w))+" ",1),vo])])):(x(),R("span",ho,"—"))]),title:l(()=>[P(o(f.$t("Available INJ for Delegation")),1)]),_:1})])}}}),yo={class:"xs:grid 2md:grid-cols-2 grid-cols-2 items-center md:grid-cols-1 lg:grid-cols-3"},xo={class:"col-span-1"},bo={class:"xs:mt-0 2md:mt-0 xs:text-right 2md:text-right xs:col-span-1 mt-4 text-center md:mt-4 md:text-center lg:col-span-2"},wo={class:"dark:shadow-dark-sm inline-flex w-auto flex-wrap justify-center rounded-2xl bg-gray-200 p-px shadow-sm dark:bg-gray-900"},Ao=G({__name:"Filter",props:{validatorStatus:{required:!0,type:String}},emits:["status:selected"],setup(u,{emit:m}){const a=Z(),n=i(()=>a.validators.filter(({status:c,jailed:b})=>c===X.Bonded&&!b).length),r=i(()=>a.validators.filter(({status:c,jailed:b})=>c!==X.Bonded||b).length);function A(c){m("status:selected",c)}return(c,b)=>{const w=kt,p=St;return x(),R("div",yo,[t("div",xo,[s(w,T(c.$attrs,{"is-dense":"",name:"search",placeholder:c.$t("staking.searchForValidators")}),null,16,["placeholder"])]),t("div",bo,[t("div",wo,[s(p,{option:e(se).Active,value:u.validatorStatus,onSelected:A},{default:l(()=>[P(o(c.$t(e(se).Active))+" ("+o(e(n))+") ",1)]),_:1},8,["option","value"]),s(p,{option:e(se).Inactive,value:u.validatorStatus,onSelected:A},{default:l(()=>[P(o(c.$t(e(se).Inactive))+" ("+o(e(r))+") ",1)]),_:1},8,["option","value"])])])])}}}),ko={class:"mr-4 w-full truncate"},So={class:"flex items-center"},Co={class:"4xl:max-w-none truncate"},Io={class:"truncate"},Do={class:"block text-xs text-gray-400 dark:text-gray-500 xl:text-xs 2xl:text-sm"},Ro={class:"col-span-1 text-left font-mono xl:hidden"},Vo={class:"col-span-1 flex items-center justify-end font-mono xl:col-span-2"},Bo=t("span",{class:"ml-1 text-xs text-gray-400 dark:text-gray-500"},"INJ",-1),Po={class:"col-span-1 text-left font-mono xl:hidden"},To={class:"col-span-1 text-right font-mono xl:col-span-2"},Mo={class:"col-span-1 text-left font-mono xl:hidden"},Uo={class:"col-span-1 text-right font-mono xl:col-span-2"},No={class:"col-span-1 flex items-center text-left font-mono xl:hidden"},jo={class:"col-span-1 text-right font-mono xl:col-span-2"},Fo={key:0},Oo={key:1,class:"text-xs text-gray-400 dark:text-gray-500"},Eo={class:"col-span-2 mt-2 -mr-2 text-right xl:mt-0 xl:mr-0"},Lo={class:"justify-end xl:flex"},Wo=G({__name:"Row",props:{index:{required:!0,type:Number},totalDelegatedAmount:{required:!0,type:String},validator:{required:!0,type:Object}},emits:["delegate"],setup(u,{emit:m}){const a=u,n=Ve(),r=ct(),A=i(()=>ut(a.validator.address)),c=i(()=>new B(a.validator.tokens).toFormat(N)),b=i(()=>new B(a.validator.commissionRate).times(100).toFormat(N)),w=i(()=>new B(a.validator.delegatorShares).dividedBy(a.totalDelegatedAmount).times(100).toFormat(N)),p=i(()=>new B(a.validator.uptimePercentage)),f=i(()=>p.value.toFormat(N));function V(){r.push({name:"validators-validator",params:{validator:a.validator.address}})}function I(){m("delegate",a.validator)}return(_,v)=>{const d=Pe,h=Ue,M=_e,D=Te;return x(),L(D,{sm:""},{default:l(()=>[t("div",{class:"col-span-2 mb-2 flex cursor-pointer items-center xl:mb-0",onClick:V},[s(d,{validator:u.validator,sm:""},null,8,["validator"]),t("div",ko,[t("div",So,[t("span",Co,[t("span",Io,o(u.validator.name),1)]),s(h,{class:"ml-2",tooltip:u.validator.status},null,8,["tooltip"])]),t("span",Do,o(e(A)),1)])]),t("span",Ro,o(_.$t("Staked Amount")),1),t("span",Vo,[P(o(e(c))+" ",1),Bo]),t("span",Po,o(_.$t("Commission")),1),t("span",To,o(e(b))+"% ",1),t("span",Mo,o(_.$t("proposal.vote.power")),1),t("span",Uo,o(e(w))+"% ",1),t("span",No,[P(o(_.$t("Uptime"))+" ",1),s(h,{class:"ml-2",tooltip:_.$t("Uptime Percentage")},null,8,["tooltip"])]),t("span",jo,[e(p).isNaN()?(x(),R("span",Oo," — ")):(x(),R("span",Fo,o(`${e(f)}%`),1))]),t("span",Eo,[t("div",Lo,[s(M,{class:"flex-1",sm:"",text:"",primary:"",onClick:V},{default:l(()=>[P(o(_.$t("Details")),1)]),_:1}),e(n).isUserWalletConnected?(x(),L(M,{key:0,text:"",primary:"",sm:"",class:"flex-1",onClick:I},{default:l(()=>[P(o(_.$t("Delegate Now")),1)]),_:1})):ee("",!0)])])]),_:1})}}}),qo={class:"w-full overflow-x-auto lg:overflow-x-visible"},Jo={class:"col-span-2"},Ho={class:"col-span-2"},zo={class:"col-span-2"},Go={class:"col-span-2 text-right"},Zo={class:"col-span-2 text-right"},Ko=t("span",{class:"col-span-2"},null,-1),Yo=G({__name:"Index",props:{search:{required:!0,type:String},totalDelegatedAmount:{required:!0,type:String},validatorStatus:{required:!0,type:String}},setup(u){const m=u,a=Z(),n=be(),r=F(!1),A=F(!1),c=F(!0),b=F(!1),w=F(""),p=F(void 0),f=i(()=>{const y=m.search.toLowerCase();return a.validators.filter(C=>{const U=C.name.toLowerCase(),g=C.address.toLowerCase(),H=U.includes(y)||g.includes(y);return m.validatorStatus===se.Active?H&&C.status===X.Bonded&&C.jailed===!1:H&&(C.status!==X.Bonded||C.jailed===!0)})}),V=i(()=>w.value===j.Commission?[...f.value].sort((y,C)=>new B(C.commissionRate).minus(y.commissionRate).toNumber()):w.value===j.Uptime?[...f.value].sort((y,C)=>{const U=y.uptimePercentage,g=C.uptimePercentage;return new B(g).minus(U).toNumber()}):w.value===j.Validator?[...f.value].sort((y,C)=>C.name.localeCompare(y.name,"en",{ignorePunctuation:!0})):[...f.value].sort((y,C)=>new B(C.delegatorShares).minus(y.delegatorShares).toNumber())),I=i(()=>b.value?V.value.reverse():V.value),_=i(()=>w.value!==""?I.value:[...I.value].sort((y,C)=>{const U=y.name.includes(Ee),g=C.name.includes(Ee);return U&&!g?1:!U&&g?-1:0})),v=i(()=>c.value?[...I.value].sort(()=>Math.random()-.5).sort(y=>new B(y.delegatorShares).dividedBy(m.totalDelegatedAmount).times(100).gte(5)?1:-1):_.value);function d(y){y!==w.value?(w.value=y,b.value=!1,c.value=!1):b.value?(b.value=!1,w.value="",c.value=!0):(b.value=!0,c.value=!1)}function h(){p.value=void 0}function M(){r.value=!0}function D(){r.value=!1}function W(){A.value=!0}function q(){A.value=!1}function S(y){return p.value=y,new B(y.commissionRate).isEqualTo(100)?M():new B(y.delegatorShares).dividedBy(m.totalDelegatedAmount).times(100).gt(5)?W():O(y)}function $(){p.value&&n.openModal(Q.DelegateToValidator)}function O(y){p.value=y,n.openModal(Q.DelegateToValidator)}return(y,C)=>{const U=Ct,g=Ue,H=Be,te=Wo,le=Me,k=Ye,E=Ze,K=Ke,ie=It;return x(),R("div",qo,[s(H,{class:"xl:mb-0"},{default:l(()=>[t("span",Jo,[s(U,T({value:e(j).Validator},{sortBy:e(w),isAscending:e(b)},{"onItem:sorted":d}),{default:l(()=>[P(o(y.$t("Validator")),1)]),_:1},16,["value"])]),t("span",Ho,[s(U,T({class:"justify-end",value:e(j).StakedAmount},{sortBy:e(w),isAscending:e(b)},{"onItem:sorted":d}),{default:l(()=>[P(o(y.$t("Staked Amount")),1)]),_:1},16,["value"])]),t("span",zo,[s(U,T({class:"justify-end",value:e(j).Commission},{sortBy:e(w),isAscending:e(b)},{"onItem:sorted":d}),{default:l(()=>[P(o(y.$t("Commission")),1)]),_:1},16,["value"])]),t("span",Go,[s(U,T({class:"justify-end",value:e(j).VotingPower},{sortBy:e(w),isAscending:e(b)},{"onItem:sorted":d}),{default:l(()=>[P(o(y.$t("proposal.vote.power")),1)]),_:1},16,["value"])]),t("span",Zo,[s(U,T({class:"justify-end",value:e(j).Uptime},{sortBy:e(w),isAscending:e(b)},{"onItem:sorted":d}),{default:l(()=>[P(o(y.$t("Uptime"))+" ",1),s(g,{class:"ml-2",tooltip:y.$t("Uptime Percentage")},null,8,["tooltip"])]),_:1},16,["value"])]),Ko]),_:1}),s(le,{class:"mt-6 lg:mt-0 lg:grid-cols-2 xl:mt-6 xl:grid-cols-1"},{default:l(()=>[(x(!0),R(ye,null,Ie(e(v),(ae,re)=>(x(),L(te,{key:`validator-${ae.address}`,"total-delegated-amount":u.totalDelegatedAmount,validator:ae,index:re,onDelegate:S},null,8,["total-delegated-amount","validator","index"]))),128))]),_:1}),s(k,{validator:e(p),"onModal:closed":h},null,8,["validator"]),s(ie,null,{default:l(()=>[s(E,T({isOpen:e(r)},{"onModal:closed":D,onConfirmed:$}),null,16),s(K,T({isOpen:e(A)},{"onModal:closed":q,onConfirmed:$}),null,16)]),_:1})])}}}),Qo={class:"relative"},Xo={class:"text-xl font-bold text-gray-700 dark:text-gray-200 mb-6 lg:mb-8"},es={class:"space-y-14"},ts={class:"flex flex-col items-center text-center space-y-4 bg-gray-900 rounded-lg py-8"},as={class:"text-xl font-bold text-gray-700 dark:text-gray-200 mb-6 lg:mb-8"},os={class:"text-xl font-bold text-gray-700 dark:text-gray-200 mb-6 lg:mb-8"},Fs=G({__name:"staking",setup(u){const m=xe(),a=be(),n=ze(),r=Qe(),A=Ve(),c=Z(),b=Dt(),{$onError:w}=$e(),p=F(""),f=ue(new me(pe.Loading)),V=ue(new me(pe.Loading)),I=F(se.Active),_=i(()=>c.validators.length>0?new B(c.validators.map(h=>new B(h.delegatorShares)).reduce((h,M)=>h.plus(M),Se)).toFixed():Se.toFixed());mt(()=>{Promise.all([r.fetchAprParams(),n.getTokensUsdPriceMap([Ge]),c.fetchValidators(),b.fetchOracles()]).then(()=>{}).catch(w).finally(()=>{f.setIdle()})}),Rt(()=>{V.setLoading(),Promise.all([c.init(),m.fetchBalances()]).catch(w).finally(()=>{V.setIdle()})});function v(){a.openModal(Q.WalletConnect)}function d(h){I.value=h}return(h,M)=>{const D=Gt,W=Wa,q=lo,S=bt,$=wt,O=_e,y=$o,C=Ao,U=Yo;return x(),R("div",Qo,[t("div",null,[t("h3",Xo,o(h.$t("staking.stakingOverview")),1),e(A).isUserWalletConnected?(x(),L($,{key:0,class:ve(["mb-6 lg:mb-8 dark:text-white",{"relative min-h-[320px]":e(V).isLoading()||e(f).isLoading()}])},{default:l(()=>[s(S,ne(ge({isLoading:e(V).isLoading()||e(f).isLoading()})),{default:l(()=>[t("div",es,[s(D),e(c).delegations.length>0?(x(),L(W,ne(T({key:0},{totalDelegatedAmount:e(_)})),null,16)):ee("",!0),e(c).unbondingDelegations.length>0||e(c).reDelegations.length>0?(x(),L(q,{key:1})):ee("",!0)])]),_:1},16)]),_:1},8,["class"])):(x(),L($,{key:1,class:"dark:text-white mb-6 md:mb-8"},{default:l(()=>[t("div",ts,[t("p",null,o(h.$t("staking.viewYourStaking")),1),s(O,{primary:"",onClick:v},{default:l(()=>[P(o(h.$t("staking.connectWallet")),1)]),_:1})])]),_:1})),t("h3",as,o(h.$t("staking.staking")),1),s($,{class:"mb-6 lg:mb-8"},{default:l(()=>[s(y,{"total-delegated-amount":e(_)},null,8,["total-delegated-amount"])]),_:1}),t("h3",os,o(h.$t("Validators")),1),s($,{class:"relative mt-6"},{default:l(()=>[t("div",null,[s(C,{modelValue:e(p),"onUpdate:modelValue":M[0]||(M[0]=g=>J(p)?p.value=g:null),"validator-status":e(I),"onStatus:selected":d},null,8,["modelValue","validator-status"]),t("div",{class:ve(["relative",{"mt-8":e(f).isLoading()}])},[s(S,ne(ge({status:e(f)})),{default:l(()=>[s(U,{class:"lg:mt-8",search:e(p),"total-delegated-amount":e(_),"validator-status":e(I)},null,8,["search","total-delegated-amount","validator-status"])]),_:1},16)],2)])]),_:1})])])}}});export{Fs as default};
